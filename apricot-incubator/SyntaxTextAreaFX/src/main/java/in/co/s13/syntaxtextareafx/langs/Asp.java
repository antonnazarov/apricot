/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package in.co.s13.syntaxtextareafx.langs;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.regex.Matcher;
import java.util.regex.Pattern;
import in.co.s13.syntaxtextareafx.meta.Language;
import java.util.Collections;

/**
 *
 * @author nika
 */
public class Asp implements Language {

    String KEYWORDS[] = new String[]{"call", "case", "class", "const", "dim", "do", "each", "else", "elseif", "end", "erase", "error", "executeGlobal", "execute", "exit", "explicit", "for", "function", "get", "goto", "if", "in", "let", "loop", "me", "new", "next", "on", "option", "private", "property", "public", "randomize", "redim", "rem", "resume", "select", "set", "stop", "sub", "then", "to", "wend", "while", "with", "and", "mod", "not", "or", "xor"};
    String FUNCTIONS[] = new String[]{"abs", "array", "asc", "atn", "cbool", "cbyte", "ccur", "cdate", "cdbl", "chr", "cint", "clng", "cos", "createobject", "csng", "cstr", "date", "dateadd", "datediff", "datepart", "dateserial", "datevalue", "day", "escape", "eval", "exp", "filter", "formatcurrency", "formatdatetime", "formatnumber", "formatpercent", "getlocale", "getobject", "getref", "hex", "hour", "instr", "instrrev", "isarray", "isdate", "isempty", "isnull", "isnumeric", "isobject", "join", "lbound", "lcase", "left", "len", "log", "ltrim", "rtrim", "trim", "mid", "minute", "month", "monthname", "now", "oct", "replace", "rgb", "right", "rnd", "round", "scriptengine", "scriptenginebuildversion", "scriptenginemajorversion", "scriptengineminorversion", "second", "setlocale", "sgn", "sin", "space", "split", "sqr", "strcomp", "strreverse", "tan", "time", "timer", "timeserial", "timevalue", "typename", "ubound", "ucase", "unescape", "vartype", "weekday", "weekdayname", "year", "\\.buffer", "\\.charset", "\\.cachecontrol", "\\.contenttype", "\\.expires", "\\.expiresabsolute", "\\.isclientconnected", "\\.pics", "\\.status", "\\.addheader", "\\.appendtolog", "\\.binarywrite", "\\.clear", "\\.end", "\\.flush", "\\.redirect", "\\.write", "\\.totalbytes", "\\.binaryread", "\\.remove", "\\.removeAll", "\\.lock", "\\.unlock", "\\.application_onstart", "\\.application_onend", "\\.codepage", "\\.lcid", "\\.sessionid", "\\.timeout", "\\.abandon", "\\.session_onstart", "\\.session_onend", "\\.scripttimeout", "\\.execute", "\\.getlasterror", "\\.htmlencode", "\\.mappath", "\\.transfer", "\\.urlencode", "\\.aspcode", "\\.aspdescription", "\\.category", "\\.column", "\\.description", "\\.file", "\\.line", "\\.number", "\\.source", "\\.drives", "\\.buildpath", "\\.copyfile", "\\.copyfolder", "\\.createfolder", "\\.createtextfile", "\\.deletefile", "\\.deletefolder", "\\.driveexists", "\\.fileexists", "\\.folderexists", "\\.getabsolutepathname", "\\.getbasename", "\\.getdrive", "\\.getdrivename", "\\.getextensionname", "\\.getfile", "\\.getfilename", "\\.getfolder", "\\.getparentfoldername", "\\.getspecialfolder", "\\.gettempname", "\\.movefile", "\\.movefolder", "\\.opentextfile", "\\.atendofline", "\\.atendofstream", "\\.close", "\\.read", "\\.readall", "\\.readline", "\\.skip", "\\.skipline", "\\.writeline", "\\.writeblanklines", "\\.availablespace", "\\.driveletter", "\\.drivetype", "\\.filesystem", "\\.freespace", "\\.isready", "\\.path", "\\.rootfolder", "\\.serialnumber", "\\.sharename", "\\.totalsize", "\\.volumename", "\\.attributes", "\\.datecreated", "\\.datelastaccessed", "\\.datelastmodified", "\\.drive", "\\.name", "\\.parentfolder", "\\.shortname", "\\.shortpath", "\\.size", "\\.type", "\\.copy", "\\.delete", "\\.move", "\\.openastextstream", "\\.isrootfolder", "\\.comparemode", "\\.count", "\\.item", "\\.key", "\\.add", "\\.exists", "\\.items", "\\.keys", "\\.activeconnection", "\\.commandtext", "\\.commandtimeout", "\\.commandtype", "\\.prepared", "\\.state", "\\.cancel", "\\.createparameter", "\\.commadtimeout", "\\.connectionstring", "\\.connectiontimeout", "\\.cursorlocation", "\\.defaultdatabase", "\\.isolationlevel", "\\.mode", "\\.provider", "\\.version", "\\.begintrans", "\\.close", "\\.committrans", "\\.open", "\\.openschema", "\\.rollbacktrans", "\\.helpcontext", "\\.helpfile", "\\.nativeerror", "\\.sqlstate", "\\.actualsize", "\\.definedsize", "\\.numericscale", "\\.originalvalue", "\\.precision", "\\.underlyingvalue", "\\.value", "\\.appendChunk", "\\.getChunk", "\\.direction", "\\.parenturl", "\\.recordtype", "\\.copyrecord", "\\.deleterecord", "\\.getchildren", "\\.moverecord", "\\.absolutepage", "\\.absoluteposition", "\\.activeCommand", "\\.bof", "\\.bookmark", "\\.cachesize", "\\.cursortype", "\\.datamember", "\\.editmode", "\\.eof", "\\.index", "\\.locktype", "\\.marshaloptions", "\\.maxrecords", "\\.pagecount", "\\.pagesize", "\\.recordcount", "\\.sort", "\\.stayinsync", "\\.addnew", "\\.cancelbatch", "\\.cancelupdate", "\\.clone", "\\.comparebookmarks", "\\.find", "\\.getrows", "\\.getstring", "\\.movefirst", "\\.movelast", "\\.movenext", "\\.moveprevious", "\\.nextrecordset", "\\.requery", "\\.resync", "\\.save", "\\.seek", "\\.supports", "\\.update", "\\.updatebatch", "\\.eos", "\\.lineseparator", "\\.position", "\\.copyto", "\\.loadfromfile", "\\.readtext", "\\.savetofile", "\\.seteos", "\\.writetext"};
    String OBJECTS[] = new String[]{"response", "request", "application", "session", "server", "\\.querystring", "\\.form", "\\.cookies", "\\.servervariables", "\\.clientcertificate", "\\.contents", "\\.staticobjects", "\\.files", "\\.subfolders", "\\.parameters", "\\.properties", "\\.errors"};
    String CONSTANTS[] = new String[]{"vbBlack", "vbRed", "vbGreen", "vbYellow", "vbBlue", "vbMagenta", "vbCyan", "vbWhite", "vbBinaryCompare", "vbTextCompare", "vbSunday", "vbMonday", "vbTuesday", "vbWednesday", "vbThursday", "vbFriday", "vbSaturday", "vbUseSystemDayOfWeek", "vbFirstJan1", "vbFirstFourDays", "vbFirstFullWeek", "vbGeneralDate", "vbLongDate", "vbShortDate", "vbLongTime", "vbShortTime", "vbObjectError", "vbOKOnly", "vbOKCancel", "vbAbortRetryIgnore", "vbYesNoCancel", "vbYesNo", "vbRetryCancel", "vbCritical", "vbQuestion", "vbExclamation", "vbInformation", "vbDefaultButton1", "vbDefaultButton2", "vbDefaultButton3", "vbDefaultButton4", "vbApplicationModal", "vbSystemModal", "vbCr", "vbCrLf", "vbFormFeed", "vbLf", "vbNewLine", "vbNullChar", "vbNullString", "vbTab", "vbVerticalTab", "vbUseDefault", "vbTrue", "vbFalse", "vbEmpty", "vbNull", "vbInteger", "vbLong", "vbSingle", "vbDouble", "vbCurrency", "vbDate", "vbString", "vbObject", "vbError", "vbBoolean", "vbVariant", "vbDataObject", "vbDecimal", "vbByte", "vbArray", "adOpenForwardOnly", "adOpenKeyset", "adOpenDynamic", "adOpenStatic", "adHoldRecords", "adMovePrevious", "adAddNew", "adDelete", "adUpdate", "adBookmark", "adApproxPosition", "adUpdateBatch", "adResync", "adNotify", "adFind", "adSeek", "adIndex", "adLockReadOnly", "adLockPessimistic", "adLockOptimistic", "adLockBatchOptimistic", "adAsyncExecute", "adAsyncFetch", "adAsyncFetchNonBlocking", "adExecuteNoRecords", "adExecuteStream", "adAsyncConnect", "adStateClosed", "adStateOpen", "adStateConnecting", "adStateExecuting", "adStateFetching", "adUseServer", "adUseClient", "adEmpty", "adTinyInt", "adSmallInt", "adInteger", "adBigInt", "adUnsignedTinyInt", "adUnsignedSmallInt", "adUnsignedInt", "adUnsignedBigInt", "adSingle", "adDouble", "adCurrency", "adDecimal", "adNumeric", "adBoolean", "adError", "adUserDefined", "adVariant", "adIDispatch", "adIUnknown", "adGUID", "adDate", "adDBDate", "adDBTime", "adDBTimeStamp", "adBSTR", "adChar", "adVarChar", "adLongVarChar", "adWChar", "adVarWChar", "adLongVarWChar", "adBinary", "adVarBinary", "adLongVarBinary", "adChapter", "adFileTime", "adPropVariant", "adVarNumeric", "adArray", "adFldMayDefer", "adFldUpdatable", "adFldUnknownUpdatable", "adFldFixed", "adFldIsNullable", "adFldMayBeNull", "adFldLong", "adFldRowID", "adFldRowVersion", "adFldCacheDeferred", "adFldIsChapter", "adFldNegativeScale", "adFldKeyColumn", "adFldIsRowURL", "adFldIsDefaultStream", "adFldIsCollection", "adEditNone", "adEditInProgress", "adEditAdd", "adEditDelete", "adRecOK", "adRecNew", "adRecModified", "adRecDeleted", "adRecUnmodified", "adRecInvalid", "adRecMultipleChanges", "adRecPendingChanges", "adRecCanceled", "adRecCantRelease", "adRecConcurrencyViolation", "adRecIntegrityViolation", "adRecMaxChangesExceeded", "adRecObjectOpen", "adRecOutOfMemory", "adRecPermissionDenied", "adRecSchemaViolation", "adRecDBDeleted", "adGetRowsRest", "adPosUnknown", "adPosBOF", "adPosEOF", "adBookmarkCurrent", "adBookmarkFirst", "adBookmarkLast", "adMarshalAll", "adMarshalModifiedOnly", "adAffectCurrent", "adAffectGroup", "adAffectAllChapters", "adResyncUnderlyingValues", "adResyncAllValues", "adCompareLessThan", "adCompareEqual", "adCompareGreaterThan", "adCompareNotEqual", "adCompareNotComparable", "adFilterNone", "adFilterPendingRecords", "adFilterAffectedRecords", "adFilterFetchedRecords", "adFilterConflictingRecords", "adSearchForward", "adSearchBackward", "adPersistADTG", "adPersistXML", "adClipString", "adPromptAlways", "adPromptComplete", "adPromptCompleteRequired", "adPromptNever", "adModeUnknown", "adModeRead", "adModeWrite", "adModeReadWrite", "adModeShareDenyRead", "adModeShareDenyWrite", "adModeShareExclusive", "adModeShareDenyNone", "adModeRecursive", "adCreateCollection", "adCreateStructDoc", "adCreateNonCollection", "adOpenIfExists", "adCreateOverwrite", "adFailIfNotExists", "adOpenRecordUnspecified", "adOpenOutput", "adOpenAsync", "adDelayFetchStream", "adDelayFetchFields", "adOpenExecuteCommand", "adXactUnspecified", "adXactChaos", "adXactReadUncommitted", "adXactBrowse", "adXactCursorStability", "adXactReadCommitted", "adXactRepeatableRead", "adXactSerializable", "adXactIsolated", "adXactCommitRetaining", "adXactAbortRetaining", "adPropNotSupported", "adPropRequired", "adPropOptional", "adPropRead", "adPropWrite", "adErrProviderFailed", "adErrInvalidArgument", "adErrOpeningFile", "adErrReadFile", "adErrWriteFile", "adErrNoCurrentRecord", "adErrIllegalOperation", "adErrCantChangeProvider", "adErrInTransaction", "adErrFeatureNotAvailable", "adErrItemNotFound", "adErrObjectInCollection", "adErrObjectNotSet", "adErrDataConversion", "adErrObjectClosed", "adErrObjectOpen", "adErrProviderNotFound", "adErrBoundToCommand", "adErrInvalidParamInfo", "adErrInvalidConnection", "adErrNotReentrant", "adErrStillExecuting", "adErrOperationCancelled", "adErrStillConnecting", "adErrInvalidTransaction", "adErrUnsafeOperation", "adwrnSecurityDialog", "adwrnSecurityDialogHeader", "adErrIntegrityViolation", "adErrPermissionDenied", "adErrDataOverflow", "adErrSchemaViolation", "adErrSignMismatch", "adErrCantConvertvalue", "adErrCantCreate", "adErrColumnNotOnThisRow", "adErrURLIntegrViolSetColumns", "adErrURLDoesNotExist", "adErrTreePermissionDenied", "adErrInvalidURL", "adErrResourceLocked", "adErrResourceExists", "adErrCannotComplete", "adErrVolumeNotFound", "adErrOutOfSpace", "adErrResourceOutOfScope", "adErrUnavailable", "adErrURLNamedRowDoesNotExist", "adErrDelResOutOfScope", "adErrPropInvalidColumn", "adErrPropInvalidOption", "adErrPropInvalidValue", "adErrPropConflicting", "adErrPropNotAllSettable", "adErrPropNotSet", "adErrPropNotSettable", "adErrPropNotSupported", "adErrCatalogNotSet", "adErrCantChangeConnection", "adErrFieldsUpdateFailed", "adErrDenyNotSupported", "adErrDenyTypeNotSupported", "adErrProviderNotSpecified", "adErrConnectionStringTooLong", "adParamSigned", "adParamNullable", "adParamLong", "adParamUnknown", "adParamInput", "adParamOutput", "adParamInputOutput", "adParamReturnValue", "adCmdUnknown", "adCmdText", "adCmdTable", "adCmdStoredProc", "adCmdFile", "adCmdTableDirect", "adStatusOK", "adStatusErrorsOccurred", "adStatusCantDeny", "adStatusCancel", "adStatusUnwantedEvent", "adRsnAddNew", "adRsnDelete", "adRsnUpdate", "adRsnUndoUpdate", "adRsnUndoAddNew", "adRsnUndoDelete", "adRsnRequery", "adRsnResynch", "adRsnClose", "adRsnMove", "adRsnFirstChange", "adRsnMoveFirst", "adRsnMoveNext", "adRsnMovePrevious", "adRsnMoveLast", "adSchemaProviderSpecific", "adSchemaAsserts", "adSchemaCatalogs", "adSchemaCharacterSets", "adSchemaCollations", "adSchemaColumns", "adSchemaCheckConstraints", "adSchemaConstraintColumnUsage", "adSchemaConstraintTableUsage", "adSchemaKeyColumnUsage", "adSchemaReferentialConstraints", "adSchemaTableConstraints", "adSchemaColumnsDomainUsage", "adSchemaIndexes", "adSchemaColumnPrivileges", "adSchemaTablePrivileges", "adSchemaUsagePrivileges", "adSchemaProcedures", "adSchemaSchemata", "adSchemaSQLLanguages", "adSchemaStatistics", "adSchemaTables", "adSchemaTranslations", "adSchemaProviderTypes", "adSchemaViews", "adSchemaViewColumnUsage", "adSchemaViewTableUsage", "adSchemaProcedureParameters", "adSchemaForeignKeys", "adSchemaPrimaryKeys", "adSchemaProcedureColumns", "adSchemaDBInfoKeywords", "adSchemaDBInfoLiterals", "adSchemaCubes", "adSchemaDimensions", "adSchemaHierarchies", "adSchemaLevels", "adSchemaMeasures", "adSchemaProperties", "adSchemaMembers", "adSchemaTrustees", "adSchemaFunctions", "adSchemaActions", "adSchemaCommands", "adSchemaSets", "adFieldOK", "adFieldCantConvertValue", "adFieldIsNull", "adFieldTruncated", "adFieldSignMismatch", "adFieldDataOverflow", "adFieldCantCreate", "adFieldUnavailable", "adFieldPermissionDenied", "adFieldIntegrityViolation", "adFieldSchemaViolation", "adFieldBadStatus", "adFieldDefault", "adFieldIgnore", "adFieldDoesNotExist", "adFieldInvalidURL", "adFieldResourceLocked", "adFieldResourceExists", "adFieldCannotComplete", "adFieldVolumeNotFound", "adFieldOutOfSpace", "adFieldCannotDeleteSource", "adFieldReadOnly", "adFieldResourceOutOfScope", "adFieldAlreadyExists", "adFieldPendingInsert", "adFieldPendingDelete", "adFieldPendingChange", "adFieldPendingUnknown", "adFieldPendingUnknownDelete", "adSeekFirstEQ", "adSeekLastEQ", "adSeekAfterEQ", "adSeekAfter", "adSeekBeforeEQ", "adSeekBefore", "adCriteriaKey", "adCriteriaAllCols", "adCriteriaUpdCols", "adCriteriaTimeStamp", "adPriorityLowest", "adPriorityBelowNormal", "adPriorityNormal", "adPriorityAboveNormal", "adPriorityHighest", "adRecalcUpFront", "adRecalcAlways", "adResyncNone", "adResyncAutoIncrement", "adResyncConflicts", "adResyncUpdates", "adResyncInserts", "adResyncAll", "adMoveUnspecified", "adMoveOverWrite", "adMoveDontUpdateLinks", "adMoveAllowEmulation", "adCopyUnspecified", "adCopyOverWrite", "adCopyAllowEmulation", "adCopyNonRecursive", "adTypeBinary", "adTypeText", "adLF", "adCR", "adCRLF", "adOpenStreamUnspecified", "adOpenStreamAsync", "adOpenStreamFromRecord", "adWriteChar", "adWriteLine", "adSaveCreateNotExist", "adSaveCreateOverWrite", "adDefaultStream", "adRecordURL", "adReadAll", "adReadLine", "adSimpleRecord", "adCollectionRecord", "adStructDoc"};
    String TYPES[] = new String[]{"boolean", "byte", "currency", "date", "double", "empty", "error", "integer", "long", "object", "single", "string"};
    String SPECIAL_CONSTANTS[] = new String[]{"nothing", "null"};
    String BOOLEAN[] = new String[]{"false", "true"};

    @Override
    public Pattern generatePattern() {
        Pattern pattern;
        String KEYWORDS_PATTERN;
        String FUNCTIONS_PATTERN;
        String OBJECTS_PATTERN;
        String CONSTANTS_PATTERN;
        String TYPES_PATTERN;
        String SPECIAL_CONSTANTS_PATTERN;
        String BOOLEAN_PATTERN;

        KEYWORDS_PATTERN = "\\b(" + String.join("|", KEYWORDS) + ")\\b";
        FUNCTIONS_PATTERN = "\\b(" + String.join("|", FUNCTIONS) + ")\\b";
        OBJECTS_PATTERN = "\\b(" + String.join("|", OBJECTS) + ")\\b";
        CONSTANTS_PATTERN = "\\b(" + String.join("|", CONSTANTS) + ")\\b";
        TYPES_PATTERN = "\\b(" + String.join("|", TYPES) + ")\\b";
        SPECIAL_CONSTANTS_PATTERN = "\\b(" + String.join("|", SPECIAL_CONSTANTS) + ")\\b";
        BOOLEAN_PATTERN = "\\b(" + String.join("|", BOOLEAN) + ")\\b";

        pattern = Pattern.compile(
                "(?<KEYWORDS>" + KEYWORDS_PATTERN + ")"
                + "|(?<FUNCTIONS>" + FUNCTIONS_PATTERN + ")"
                + "|(?<OBJECTS>" + OBJECTS_PATTERN + ")"
                + "|(?<CONSTANTS>" + CONSTANTS_PATTERN + ")"
                + "|(?<TYPES>" + TYPES_PATTERN + ")"
                + "|(?<SPECIALCONSTANTS>" + SPECIAL_CONSTANTS_PATTERN + ")"
                + "|(?<BOOLEAN>" + BOOLEAN_PATTERN + ")"
        );
        return pattern;
    }

    @Override
    public String getStyleClass(Matcher matcher) {
        return  matcher.group("KEYWORDS") != null ? "keywords"
                : matcher.group("FUNCTIONS") != null ? "functions"
                : matcher.group("OBJECTS") != null ? "objects"
                : matcher.group("CONSTANTS") != null ? "constants"
                : matcher.group("TYPES") != null ? "types"
                : matcher.group("SPECIALCONSTANTS") != null ? "special-constants"
                : matcher.group("BOOLEAN") != null ? "boolean"
                : null;
    }

    @Override
    public ArrayList<String> getKeywords() {
        ArrayList<String> keywordList = new ArrayList<>();
        keywordList.addAll(Arrays.asList(KEYWORDS));
        keywordList.addAll(Arrays.asList(FUNCTIONS));
        keywordList.addAll(Arrays.asList(OBJECTS));
        keywordList.addAll(Arrays.asList(CONSTANTS));
        keywordList.addAll(Arrays.asList(TYPES));
        keywordList.addAll(Arrays.asList(SPECIAL_CONSTANTS));
        keywordList.addAll(Arrays.asList(BOOLEAN));
        Collections.sort(keywordList);
        return keywordList;
    }

}
